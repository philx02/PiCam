<!DOCTYPE html>
<html>
<head>
<title></title>
<link rel="stylesheet" type="text/css" href="picam.css"/>
</head>
 
<body onload="connect()">

<script src="common.js"></script>

<script>

  var wWebSocket;

  function connect()
  {
  try
  {
  wWebSocket = new WebSocket(QueryString.server);
  }
  catch (exc)
  {
  document.getElementById("debug").innerHTML = exc.message;
  }
  wWebSocket.onopen = function (evt) { greetings(evt); };
  wWebSocket.onmessage = function (evt) { parseMessage(evt); };
  }

  function greetings(evt)
  {
    wWebSocket.send("get_status");
  }

  var wRecordingOverride = false;
  var wLightOverride = false;
  var wCoverageAlwaysOn = false;

  function parseMessage(evt)
  {
    //document.getElementById("debug").innerHTML = evt.data;
    var wSplit = evt.data.split("|");
    if (wSplit[0] == "1")
    {
      document.getElementById("door_switch_status").innerHTML = "ON";
      document.getElementById("door_switch_status").className = "class_on";
    }
    else
    {
      document.getElementById("door_switch_status").innerHTML = "OFF";
      document.getElementById("door_switch_status").className = "class_off";
    }
    if (wSplit[1] == "1")
    {
      document.getElementById("record_status").innerHTML = "ON";
      document.getElementById("record_status").className = "class_on";
    }
    else
    {
      document.getElementById("record_status").innerHTML = "OFF";
      document.getElementById("record_status").className = "class_off";
    }
    if (wSplit[2] == "1")
    {
      document.getElementById("light_status").innerHTML = "ON";
      document.getElementById("light_status").className = "class_on";
    }
    else
    {
      document.getElementById("light_status").innerHTML = "OFF";
      document.getElementById("light_status").className = "class_off";
    }
    wRecordingOverride = wSplit[3] == "1";
    wLightOverride = wSplit[4] == "1";
    wCoverageAlwaysOn = wSplit[5] == "1";
    if (wRecordingOverride)
    {
      document.getElementById("record_control").innerHTML = "<img class=\"toggle_button\" src=\"ON.png\" />";
    }
    else
    {
      document.getElementById("record_control").innerHTML = "<img class=\"toggle_button\" src=\"OFF.png\" />";
    }
    if (wLightOverride)
    {
      document.getElementById("light_control").innerHTML = "<img class=\"toggle_button\" src=\"ON.png\" />";
    }
    else
    {
      document.getElementById("light_control").innerHTML = "<img class=\"toggle_button\" src=\"OFF.png\" />";
    }
    if (wCoverageAlwaysOn)
    {
      document.getElementById("coverage_always_on_control").innerHTML = "<img class=\"toggle_button\" src=\"ON.png\" />";
    }
    else
    {
      document.getElementById("coverage_always_on_control").innerHTML = "<img class=\"toggle_button\" src=\"OFF.png\" />";
    }
  }

  function recording_override()
  {
    wRecordingOverride = !wRecordingOverride;
    wWebSocket.send("recording_override|" + (wRecordingOverride ? "1" : "0"));
  }

  function light_override()
  {
    wLightOverride = !wLightOverride;
    wWebSocket.send("light_override|" + (wLightOverride ? "1" : "0"));
  }

  function coverage_always_on()
  {
    wCoverageAlwaysOn = !wCoverageAlwaysOn;
    wWebSocket.send("coverage_always_on|" + (wCoverageAlwaysOn ? "1" : "0"));
  }

  function toggle_visibility(id)
  {
    var e = document.getElementById(id);
    if (e.style.display == 'block')
    {
      e.style.display = 'none';
    }
    else
    {
      e.style.display = 'block';
    }
  }

</script>
  
<div class="hidden">
	<script type="text/javascript">
		<!--//--><![CDATA[//><!--
  var images = new Array()
  function preload()
  {
    for (i = 0; i < preload.arguments.length; i++)
    {
      images[i] = new Image()
      images[i].src = preload.arguments[i]
    }
  }
  preload(
    "ON.png",
    "OFF.png"
  )
  //--><!]]>
	</script>
</div>

<p id="debug"></p>
  <p>
  <table class="status_table">
    <tr>
      <td>Door Switch</td>
      <td id="door_switch_status"></td>
    </tr>
    <tr>
      <td>Recording</td>
      <td id="record_status"></td>
    </tr>
    <tr>
      <td>Light</td>
      <td id="light_status"></td>
    </tr>
  </table>
  </p>

  <p>
    <table class="control_table">
      <tr>
        <td class="override_td">Recording Override</td>
        <td class="toggle_button_td" id="record_control" onclick="recording_override()"></td>
      </tr>
      <tr>
        <td class="override_td">Light Override</td>
        <td class="toggle_button_td" id="light_control" onclick="light_override()"></td>
      </tr>
    </table>
  </p>

  <!--
  <object align="center" classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921"
          codebase="http://downloads.videolan.org/pub/videolan/vlc/latest/win32/axvlc.cab"
          width="800" height="600" id="vlc" events="True">
    <param name="Src" value="http://spoluck.ca:8090" />
    <param name="ShowDisplay" value="True" />
    <param name="AutoLoop" value="False" />
    <param name="AutoPlay" value="True" />
    <embed id="vlcEmb" type="application/x-google-vlc-plugin" version="VideoLAN.VLCPlugin.2" autoplay="yes" loop="no" width="720" height="360"
           target="http://spoluck.ca:8090/"></embed>
  </object>
  -->

  <button onclick="toggle_visibility('config_div');">test</button>

  <div id="config_div">
    <table>
      <tr>
        <td class="coverage_td">Coverage 24/7</td>
        <td class="toggle_button_td" id="coverage_always_on_control" onclick="coverage_always_on()"></td>
      </tr>
    </table>

    <table class="week_table">
      <tr>
        <th class="week_hour">H</th>
        <th class='week_row'>Monday</th>
        <th class='week_row'>Tuesday</th>
        <th class='week_row'>Wednesday</th>
        <th class='week_row'>Thursday</th>
        <th class='week_row'>Friday</th>
        <th class='week_row'>Saturday</th>
        <th class='week_row'>Sunday</th>
        <th class="week_hour">H</th>
      </tr>
      <tr>
        <th class="week_hour">0</th>
        <th id='' class='week_row'></th>
        <th id='' class='week_row'></th>
        <th id='' class='week_row'></th>
        <th id='' class='week_row'></th>
        <th id='' class='week_row'></th>
        <th id='' class='week_row'></th>
        <th id='' class='week_row'></th>
        <th class="week_hour">0</th>
      </tr>
    </table>

  </div>

</body>
</html> 
